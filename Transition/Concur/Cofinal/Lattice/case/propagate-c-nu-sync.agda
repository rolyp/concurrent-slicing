open import ConcurrentSlicingCommon
open import Transition.Concur.Cofinal.Lattice.Common

module Transition.Concur.Cofinal.Lattice.case.propagate-c-nu-sync
   {Œì} {x : Name Œì} {P‚ÇÄ Q‚ÇÄ} where

   import Relation.Binary.EqReasoning as EqReasoning

   import Name as ·¥∫
   import Ren as ·¥ø
   import Ren.Lattice as ·¥øÃÉ
   import Transition as ·µÄ

   module ‚Ä¢x‚å©y‚å™
      {R‚ÇÄ S‚ÇÄ S‚Ä≤‚ÇÄ} {x‚Ä≤ y : Name Œì} {F : Q‚ÇÄ ‚Äî[ ‚Ä¢ x‚Ä≤ ‚å© y ‚å™ ·∂ú - _ ]‚Üí S‚ÇÄ} {F‚Ä≤ : Q‚ÇÄ ‚Äî[ (‚Ä¢ x) ·µá - _ ]‚Üí S‚Ä≤‚ÇÄ}
      (E : P‚ÇÄ ‚Äî[ x ‚Ä¢ ·µá - _ ]‚Üí R‚ÇÄ) (ùêπ : F ‚å£‚ÇÅ[ ·∂ú‚àá·µá ] F‚Ä≤) (let Q‚Ä≤‚ÇÄ = tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ); Q‚Ä≥‚ÇÄ = tgt‚ÇÇ (‚äñ‚ÇÅ ùêπ))
      (P : ‚Üì P‚ÇÄ) (Q : ‚Üì Q‚ÇÄ)
      (IH : braiding (·∂ú‚àá·µá {a = ‚Ä¢ x‚Ä≤ ‚å© y ‚å™} {‚Ä¢ x}) {0} (Œ≥‚ÇÅ ùêπ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q)) ‚â° tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) (tgt F‚Ä≤ Q))
      where

      module _
         (R : ‚Üì R‚ÇÄ) (S‚Ä≤ : ‚Üì S‚Ä≤‚ÇÄ) (P‚Ä≤ : ‚Üì Q‚Ä≤‚ÇÄ) (y‚Ä≤ y‚Ä≥ : ‚Üì ·¥∫.zero {Œì}) (‚â°R : tgt E P ‚â° R) (‚â°S‚Ä≤ : tgt F‚Ä≤ Q ‚â° S‚Ä≤)
         (‚â°P‚Ä≤ : tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q) ‚â° P‚Ä≤) (‚â°y‚Ä≥ : y‚Ä≤ ‚â° y‚Ä≥)
         where

         base :
            (Q‚Ä≥ : ‚Üì Q‚Ä≥‚ÇÄ) (‚â°Q‚Ä≥ : tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° Q‚Ä≥) ‚Üí
            braiding (·∂ú‚àá·∂ú {a = ‚Ä¢ x‚Ä≤ ‚å© y ‚å™} {œÑ}) {0} (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ)))
            [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚â°
            [ ŒΩ [ (repl y‚Ä≥ *ÃÉ) R ‚îÇ Q‚Ä≥ ] ]

         base Q‚Ä≥ ‚â°Q‚Ä≥ =
            let Œ± : ŒΩ ((id·∂† *) R‚ÇÄ ‚îÇ tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ)) ‚â° ŒΩ ((id·∂† *) R‚ÇÄ ‚îÇ Proc‚Ü± refl (tgt‚ÇÇ (‚äñ‚ÇÅ ùêπ)))
                Œ± = cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ))
                Œ¥ : P‚Ä≤ ‚âÖ Q‚Ä≥
                Œ¥ = let open ‚âÖ-Reasoning in
                   begin
                      P‚Ä≤
                   ‚â°‚ü® sym ‚â°P‚Ä≤ ‚ü©
                      tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q)
                   ‚âÖ‚ü® ‚âÖ-sym (reduce-·∂ú‚àá·µá (Œ≥‚ÇÅ ùêπ) _) ‚ü©
                      braiding (·∂ú‚àá·µá {a = ‚Ä¢ x‚Ä≤ ‚å© y ‚å™} {‚Ä¢ x}) {0} (Œ≥‚ÇÅ ùêπ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q))
                   ‚â°‚ü® IH ‚ü©
                      (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) (tgt F‚Ä≤ Q))
                   ‚â°‚ü® cong (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) ‚â°S‚Ä≤ ‚ü©
                      (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤)
                   ‚â°‚ü® ‚â°Q‚Ä≥ ‚ü©
                      Q‚Ä≥
                   ‚àé
                open ‚âÖ-Reasoning in ‚âÖ-to-‚â° (
            begin
               braiding (·∂ú‚àá·∂ú {a = ‚Ä¢ x‚Ä≤ ‚å© y ‚å™} {œÑ}) {0} Œ±
               [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚âÖ‚ü® reduce-·∂ú‚àá·∂ú Œ± _ ‚ü©
               [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚âÖ‚ü® [ŒΩ-]-cong (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ))
                         ([-‚îÇ-]-cong refl (‚â°-to-‚âÖ (cong (Œª y‚Ä† ‚Üí (repl y‚Ä† *ÃÉ) R) ‚â°y‚Ä≥)) (Œ≥‚ÇÅ ùêπ) Œ¥) ‚ü©
               [ ŒΩ [ (repl y‚Ä≥ *ÃÉ) R ‚îÇ Q‚Ä≥ ] ]
            ‚àé)

         subcase :
            braiding (·∂ú‚àá·∂ú {a = ‚Ä¢ x‚Ä≤ ‚å© y ‚å™} {œÑ}) {0} (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ)))
            [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚â°
            tgt (ŒΩ·∂ú ((id·∂† *) R‚ÇÄ ‚îÇ·∂ú E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) [ ŒΩ [ (repl y‚Ä≥ *ÃÉ) R ‚îÇ S‚Ä≤ ] ]
         subcase
            with step (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ | inspect (step (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) S‚Ä≤
         ... | ‚óª , Q‚Ä≥ | [ ‚â°Q‚Ä≥ ] = base Q‚Ä≥ (,-inj‚ÇÇ ‚â°Q‚Ä≥)
         ... | [ ‚Ä¢ ._ ‚å© ‚óª ‚å™ ·∂ú ] , Q‚Ä≥ | [ ‚â°Q‚Ä≥ ] = base Q‚Ä≥ (,-inj‚ÇÇ ‚â°Q‚Ä≥)
         ... | [ ‚Ä¢ .(·¥∫.suc x‚Ä≤) ‚å© [ .(·¥∫.suc y) ] ‚å™ ·∂ú ] , Q‚Ä≥ | [ ‚â°Q‚Ä≥ ] = base Q‚Ä≥ (,-inj‚ÇÇ ‚â°Q‚Ä≥)

      case :
         braiding (·∂ú‚àá·∂ú {a = ‚Ä¢ x‚Ä≤ ‚å© y ‚å™} {œÑ}) {0} (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ)))
         (tgt (E ‚îÇ·µ• E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt (P‚ÇÄ ‚îÇ·∂ú F) [ P ‚îÇ Q ]))
         ‚â°
         tgt (ŒΩ·∂ú ((id·∂† *) (·µÄ.tgt E) ‚îÇ·∂ú E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) (tgt (E ‚îÇ·µ• F‚Ä≤) [ P ‚îÇ Q ])
      case
         with step E P | step F‚Ä≤ Q | step (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q) |
              inspect (step E) P | inspect (step F‚Ä≤) Q | inspect (step (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) (tgt F Q)
      case | _ , R | ‚óª , S‚Ä≤ | [ _ ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         ‚ä•-elim (‚óª‚â¢[-] (trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤))))
      case | _ , R | [ _ ] , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         ‚ä•-elim (‚óª‚â¢[-] (trans (,-inj‚ÇÅ (sym ‚â°P‚Ä≤)) (trans (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q)) (,-inj‚ÇÅ ‚â°S‚Ä≤))))
      case | _ , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         let Œ± = trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤)) in
         ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (sym Œ±))
      case | _ , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         let Œ± = trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤)) in
         ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] Œ±)
      case | ‚óª , R | ‚óª , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | ‚óª , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | ‚óª , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ [ ·¥∫.zero ] [ ·¥∫.zero ] (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | [ .x ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | [ .x ‚Ä¢ ·µá ] , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | [ .x ‚Ä¢ ·µá ] , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ [ ·¥∫.zero ] [ ·¥∫.zero ] (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl

   module œÑ
      {R‚ÇÄ S‚ÇÄ S‚Ä≤‚ÇÄ} {F : Q‚ÇÄ ‚Äî[ œÑ ·∂ú - _ ]‚Üí S‚ÇÄ} {F‚Ä≤ : Q‚ÇÄ ‚Äî[ (‚Ä¢ x) ·µá - _ ]‚Üí S‚Ä≤‚ÇÄ}
      (E : P‚ÇÄ ‚Äî[ x ‚Ä¢ ·µá - _ ]‚Üí R‚ÇÄ) (ùêπ : F ‚å£‚ÇÅ[ ·∂ú‚àá·µá ] F‚Ä≤) (let Q‚Ä≤‚ÇÄ = tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ); Q‚Ä≥‚ÇÄ = tgt‚ÇÇ (‚äñ‚ÇÅ ùêπ))
      (P : ‚Üì P‚ÇÄ) (Q : ‚Üì Q‚ÇÄ)
      (IH : braiding (·∂ú‚àá·µá {a = œÑ} {‚Ä¢ x}) {0} (Œ≥‚ÇÅ ùêπ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q)) ‚â° tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) (tgt F‚Ä≤ Q))
      where

      module _
         (R : ‚Üì R‚ÇÄ) (S‚Ä≤ : ‚Üì S‚Ä≤‚ÇÄ) (P‚Ä≤ : ‚Üì Q‚Ä≤‚ÇÄ) (y‚Ä≤ y‚Ä≥ : ‚Üì ·¥∫.zero {Œì}) (‚â°R : tgt E P ‚â° R) (‚â°S‚Ä≤ : tgt F‚Ä≤ Q ‚â° S‚Ä≤)
         (‚â°P‚Ä≤ : tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q) ‚â° P‚Ä≤) (‚â°y‚Ä≥ : y‚Ä≤ ‚â° y‚Ä≥)
         where

         base :
            (Q‚Ä≥ : ‚Üì Q‚Ä≥‚ÇÄ) (‚â°Q‚Ä≥ : tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° Q‚Ä≥) ‚Üí
            braiding (·∂ú‚àá·∂ú {a = œÑ} {œÑ}) {0} (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ)))
            [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚â°
            [ ŒΩ [ (repl y‚Ä≥ *ÃÉ) R ‚îÇ Q‚Ä≥ ] ]
         base Q‚Ä≥ ‚â°Q‚Ä≥ =
            let Œ± : ŒΩ ((id·∂† *) R‚ÇÄ ‚îÇ tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ)) ‚â° ŒΩ ((id·∂† *) R‚ÇÄ ‚îÇ Proc‚Ü± refl (tgt‚ÇÇ (‚äñ‚ÇÅ ùêπ)))
                Œ± = cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ))
                Œ¥ : P‚Ä≤ ‚âÖ Q‚Ä≥
                Œ¥ = let open ‚âÖ-Reasoning in
                   begin
                      P‚Ä≤
                   ‚â°‚ü® sym ‚â°P‚Ä≤ ‚ü©
                      tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q)
                   ‚âÖ‚ü® ‚âÖ-sym (reduce-·∂ú‚àá·µá (Œ≥‚ÇÅ ùêπ) _) ‚ü©
                      braiding (·∂ú‚àá·µá {a = œÑ} {‚Ä¢ x}) {0} (Œ≥‚ÇÅ ùêπ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q))
                   ‚â°‚ü® IH ‚ü©
                      (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) (tgt F‚Ä≤ Q))
                   ‚â°‚ü® cong (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) ‚â°S‚Ä≤ ‚ü©
                      (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤)
                   ‚â°‚ü® ‚â°Q‚Ä≥ ‚ü©
                      Q‚Ä≥
                   ‚àé
                open ‚âÖ-Reasoning in ‚âÖ-to-‚â° (
            begin
               braiding (·∂ú‚àá·∂ú {a = œÑ} {œÑ}) {0} Œ± [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚âÖ‚ü® reduce-·∂ú‚àá·∂ú Œ± _ ‚ü©
               [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚âÖ‚ü® [ŒΩ-]-cong (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ))
                         ([-‚îÇ-]-cong refl (‚â°-to-‚âÖ (cong (Œª y‚Ä† ‚Üí (repl y‚Ä† *ÃÉ) R) ‚â°y‚Ä≥)) (Œ≥‚ÇÅ ùêπ) Œ¥) ‚ü©
               [ ŒΩ [ (repl y‚Ä≥ *ÃÉ) R ‚îÇ Q‚Ä≥ ] ]
            ‚àé)

         subcase :
            braiding (·∂ú‚àá·∂ú {a = œÑ} {œÑ}) {0} (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ)))
            [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ P‚Ä≤ ] ]
            ‚â°
            tgt (ŒΩ·∂ú ((id·∂† *) R‚ÇÄ ‚îÇ·∂ú E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) [ ŒΩ [ (repl y‚Ä≥ *ÃÉ) R ‚îÇ S‚Ä≤ ] ]
         subcase with step (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ | inspect (step (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) S‚Ä≤
         ... | ‚óª , Q‚Ä≥ | [ ‚â°Q‚Ä≥ ] = base Q‚Ä≥ (,-inj‚ÇÇ ‚â°Q‚Ä≥)
         ... | [ œÑ ·∂ú ] , Q‚Ä≥ | [ ‚â°Q‚Ä≥ ] = base Q‚Ä≥ (,-inj‚ÇÇ ‚â°Q‚Ä≥)

      case :
         braiding (·∂ú‚àá·∂ú {a = œÑ} {œÑ}) {0} (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ refl (Œ≥‚ÇÅ ùêπ)))
         (tgt (E ‚îÇ·µ• E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt (P‚ÇÄ ‚îÇ·∂ú F) [ P ‚îÇ Q ]))
         ‚â°
         tgt (ŒΩ·∂ú ((id·∂† *) (·µÄ.tgt E) ‚îÇ·∂ú E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) (tgt (E ‚îÇ·µ• F‚Ä≤) [ P ‚îÇ Q ])
      case
         with step E P | step F‚Ä≤ Q | step (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q) |
              inspect (step E) P | inspect (step F‚Ä≤) Q | inspect (step (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) (tgt F Q)
      case | ‚óª , R | ‚óª , S‚Ä≤ | [ _ ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         ‚ä•-elim (‚óª‚â¢[-] (trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤))))
      case | ‚óª , R | [ _ ] , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         ‚ä•-elim (‚óª‚â¢[-] (trans (,-inj‚ÇÅ (sym ‚â°P‚Ä≤)) (trans (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q)) (,-inj‚ÇÅ ‚â°S‚Ä≤))))
      case | ‚óª , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         let Œ± = trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤)) in
         ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (sym Œ±))
      case | ‚óª , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         let Œ± = trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤)) in
         ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] Œ±)
      case | [ .x ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | [ _ ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         ‚ä•-elim (‚óª‚â¢[-] (trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤))))
      case | [ .x ‚Ä¢ ·µá ] , R | [ _ ] , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         ‚ä•-elim (‚óª‚â¢[-] (trans (,-inj‚ÇÅ (sym ‚â°P‚Ä≤)) (trans (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q)) (,-inj‚ÇÅ ‚â°S‚Ä≤))))
      case | [ .x ‚Ä¢ ·µá ] , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         let Œ± = trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤)) in
         ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] Œ±)
      case | [ .x ‚Ä¢ ·µá ] , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         let Œ± = trans (sym (,-inj‚ÇÅ ‚â°S‚Ä≤)) (trans (sym (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))) (,-inj‚ÇÅ ‚â°P‚Ä≤)) in
         ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (sym Œ±))
      case | ‚óª , R | ‚óª , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | ‚óª , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | ‚óª , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ [ ·¥∫.zero ] [ ·¥∫.zero ] (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | [ .x ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | ‚óª , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | [ .x ‚Ä¢ ·µá ] , R | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô ‚óª Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
      case | [ .x ‚Ä¢ ·µá ] , R | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ .x Ôπô [ .·¥∫.zero ] Ôπö ·µá ] , P‚Ä≤ | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°P‚Ä≤ ] =
         subcase R S‚Ä≤ P‚Ä≤ [ ·¥∫.zero ] [ ·¥∫.zero ] (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°S‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≤) refl
