open import ConcurrentSlicingCommon
import Relation.Binary.EqReasoning as EqReasoning
open import Transition.Concur.Cofinal.Lattice.Common
import Name as ·¥∫
import Ren as ·¥ø

module Transition.Concur.Cofinal.Lattice.case.nu-sync-nu-sync
   {Œì} {x u : Name Œì} {P‚ÇÄ Q‚ÇÄ R‚ÇÄ R‚Ä≤‚ÇÄ S‚ÇÄ S‚Ä≤‚ÇÄ} {E : P‚ÇÄ ‚Äî[ x ‚Ä¢ ·µá - _ ]‚Üí R‚ÇÄ}
   {E‚Ä≤ : P‚ÇÄ ‚Äî[ u ‚Ä¢ ·µá - _ ]‚Üí R‚Ä≤‚ÇÄ} {F : Q‚ÇÄ ‚Äî[ (‚Ä¢ x) ·µá - _ ]‚Üí S‚ÇÄ} {F‚Ä≤ : Q‚ÇÄ ‚Äî[ (‚Ä¢ u) ·µá - _ ]‚Üí S‚Ä≤‚ÇÄ}
   (ùê∏ : E ‚å£‚ÇÅ[ ·µá‚àá·µá ] E‚Ä≤) (ùêπ : F ‚å£‚ÇÅ[ ·µá‚àá·µá ] F‚Ä≤) (P : ‚Üì P‚ÇÄ) (Q : ‚Üì Q‚ÇÄ)
   (IH‚ÇÅ : braiding (·µá‚àá·µá {a = x ‚Ä¢} {u ‚Ä¢}) {0} (Œ≥‚ÇÅ ùê∏) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P)) ‚â° tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)) (tgt E‚Ä≤ P))
   (IH‚ÇÇ : braiding (·µá‚àá·µá {a = ‚Ä¢ x} {‚Ä¢ u}) {0} (Œ≥‚ÇÅ ùêπ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q)) ‚â° tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) (tgt F‚Ä≤ Q)) where

   module _
      (R : ‚Üì R‚ÇÄ) (R‚Ä≤ : ‚Üì R‚Ä≤‚ÇÄ) (S : ‚Üì S‚ÇÄ) (S‚Ä≤ : ‚Üì S‚Ä≤‚ÇÄ) (y y‚Ä≤ : ‚Üì ·¥∫.zero) (‚â°R : tgt E P ‚â° R) (‚â°R‚Ä≤ : tgt E‚Ä≤ P ‚â° R‚Ä≤)
      (‚â°S : tgt F Q ‚â° S) (‚â°S‚Ä≤ : tgt F‚Ä≤ Q ‚â° S‚Ä≤) (‚â°y : (y ‚â° ‚óª √ó action F‚Ä≤ Q ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action F‚Ä≤ Q ‚â° [ ‚Ä¢ u Ôπô y Ôπö ·µá ])
      (‚â°y‚Ä≤ : (y‚Ä≤ ‚â° ‚óª √ó action F Q ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action F Q ‚â° [ ‚Ä¢ x Ôπô y‚Ä≤ Ôπö ·µá ])
      where

      ‚â°a‚Ä≤/a : action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° (push ·¥¨*ÃÉ) (action F‚Ä≤ Q)
      ‚â°a‚Ä≤/a = trans (cong (action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) (sym ‚â°S)) (œÄ‚ÇÅ (·¥¨gamma‚ÇÅ ùêπ Q))

      z‚ÇÅ‚â°z‚ÇÇ : (z‚ÇÅ : ‚Üì ·¥∫.zero) (z‚ÇÇ : ‚Üì ·¥∫.zero)
              (Œ± : (z‚ÇÅ ‚â° ‚óª √ó action F‚Ä≤ Q ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action F‚Ä≤ Q ‚â° [ ‚Ä¢ u Ôπô z‚ÇÅ Ôπö ·µá ])
              (Œ≤ : (z‚ÇÇ ‚â° ‚óª √ó action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° [ ‚Ä¢ ·¥∫.suc u Ôπô z‚ÇÇ Ôπö ·µá ]) ‚Üí
              weaken ÃÉ z‚ÇÅ ‚â° z‚ÇÇ
      z‚ÇÅ‚â°z‚ÇÇ ‚óª ‚óª _ _ = refl
      z‚ÇÅ‚â°z‚ÇÇ [ .·¥∫.zero ] [ .·¥∫.zero ] _ _ = refl
      z‚ÇÅ‚â°z‚ÇÇ ‚óª [ .·¥∫.zero ] Œ± Œ≤ =
         let Œ¥ : action F‚Ä≤ Q ‚â° [ ‚Ä¢ u Ôπô [ ·¥∫.zero ] Ôπö ·µá ]
             Œ¥ = inj-residual (·µá‚àá·µá {a‚Ä≤ = ‚Ä¢ u}) (action F‚Ä≤ Q) _ (trans (sym ‚â°a‚Ä≤/a) (Œ≤ (Œª { (() , _) })))
         in ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (trans (sym (Œ± (Œª { (_ , Œ¥‚Ä≤) ‚Üí ‚óª‚â¢[-] (trans (sym Œ¥‚Ä≤) Œ¥) }))) Œ¥))
      z‚ÇÅ‚â°z‚ÇÇ [ .·¥∫.zero ] ‚óª Œ± Œ≤ =
         let Œ¥ : action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° [ ‚Ä¢ ·¥∫.suc u Ôπô [ ·¥∫.zero ] Ôπö ·µá ]
             Œ¥ = trans ‚â°a‚Ä≤/a (cong (push ·¥¨*ÃÉ) (Œ± (Œª { (() , _) })))
         in ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (trans (sym (Œ≤ (Œª { (_ , Œ¥‚Ä≤) ‚Üí ‚óª‚â¢[-] (trans (sym Œ¥‚Ä≤) Œ¥) }))) Œ¥))

      ‚â°a/a‚Ä≤ : action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° (push ·¥¨*ÃÉ) (action F Q)
      ‚â°a/a‚Ä≤ = trans (cong (action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) (sym ‚â°S‚Ä≤)) (œÄ‚ÇÇ (·¥¨gamma‚ÇÅ ùêπ Q))

      y‚ÇÅ‚â°y‚ÇÇ : (y‚ÇÅ : ‚Üì ·¥∫.zero) (y‚ÇÇ : ‚Üì ·¥∫.zero)
              (Œ± : (y‚ÇÅ ‚â° ‚óª √ó action F Q ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action F Q ‚â° [ ‚Ä¢ x Ôπô y‚ÇÅ Ôπö ·µá ])
              (Œ≤ : (y‚ÇÇ ‚â° ‚óª √ó action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° [ ‚Ä¢ ·¥∫.suc x Ôπô y‚ÇÇ Ôπö ·µá ]) ‚Üí
              weaken ÃÉ y‚ÇÅ ‚â° y‚ÇÇ
      y‚ÇÅ‚â°y‚ÇÇ ‚óª ‚óª _ _ = refl
      y‚ÇÅ‚â°y‚ÇÇ [ .·¥∫.zero ] [ .·¥∫.zero ] _ _ = refl
      y‚ÇÅ‚â°y‚ÇÇ ‚óª [ .·¥∫.zero ] Œ± Œ≤ =
         let Œ¥ : action F Q ‚â° [ ‚Ä¢ x Ôπô [ ·¥∫.zero ] Ôπö ·µá ]
             Œ¥ = inj-residual (·µá‚àá·µá {a‚Ä≤ = ‚Ä¢ u}) (action F Q) _ (trans (sym ‚â°a/a‚Ä≤) (Œ≤ (Œª { (() , _) })))
         in ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (trans (sym (Œ± (Œª { (_ , Œ¥‚Ä≤) ‚Üí ‚óª‚â¢[-] (trans (sym Œ¥‚Ä≤) Œ¥) }))) Œ¥))
      y‚ÇÅ‚â°y‚ÇÇ [ .·¥∫.zero ] ‚óª Œ± Œ≤ =
         let Œ¥ : action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° [ ‚Ä¢ ·¥∫.suc x Ôπô [ ·¥∫.zero ] Ôπö ·µá ]
             Œ¥ = trans ‚â°a/a‚Ä≤ (cong (push ·¥¨*ÃÉ) (Œ± (Œª { (() , _) })))
         in ‚ä•-elim ([‚Ä¢xÔπô‚óªÔπö·µá]‚â¢[‚Ä¢xÔπô[zero]Ôπö·µá] (trans (sym (Œ≤ (Œª { (_ , Œ¥‚Ä≤) ‚Üí ‚óª‚â¢[-] (trans (sym Œ¥‚Ä≤) Œ¥) }))) Œ¥))

      base : (P‚Ä≤ : ‚Üì (·¥ø.suc id·∂† *) (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏))) (Q‚Ä≤ : ‚Üì tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ)) (P‚Ä≥ : ‚Üì (·¥ø.suc id·∂† *) (tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏)))
             (Q‚Ä≥ : ‚Üì tgt‚ÇÇ (‚äñ‚ÇÅ ùêπ)) (y‚Ä† y‚Ä° : ‚Üì ·¥∫.zero) ‚Üí tgt ((id·∂† *·µá) (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏))) ((repl y‚Ä≤ *ÃÉ) R) ‚â° P‚Ä≤ ‚Üí
             tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° Q‚Ä≤ ‚Üí tgt ((id·∂† *·µá) (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏))) ((repl y *ÃÉ) R‚Ä≤) ‚â° P‚Ä≥ ‚Üí tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° Q‚Ä≥ ‚Üí
             ((y‚Ä† ‚â° ‚óª √ó action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S ‚â° [ ‚Ä¢ ·¥∫.suc u Ôπô y‚Ä† Ôπö ·µá ]) ‚Üí
             ((y‚Ä° ‚â° ‚óª √ó action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° ‚óª ‚Üí ‚ä•) ‚Üí action (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ ‚â° [ ‚Ä¢ ·¥∫.suc x Ôπô y‚Ä° Ôπö ·µá ]) ‚Üí
             braidÃÇ (Œ≥‚ÇÅ (ùê∏ ‚îÇ·µ•‚Ä≤ ùêπ)) [ ŒΩ [ ŒΩ [ (repl y‚Ä† *ÃÉ) P‚Ä≤ ‚îÇ Q‚Ä≤ ] ] ] ‚â° [ ŒΩ [ ŒΩ [ (repl y‚Ä° *ÃÉ) P‚Ä≥ ‚îÇ Q‚Ä≥ ] ] ]
      base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† y‚Ä° ‚â°P‚Ä≤ ‚â°Q‚Ä≤ ‚â°P‚Ä≥ ‚â°Q‚Ä≥ ‚â°y‚Ä† ‚â°y‚Ä° =
         let Œ≤ : (swap *ÃÉ) ((repl y‚Ä† *ÃÉ) P‚Ä≤) ‚âÖ (repl y‚Ä° *ÃÉ) P‚Ä≥
             Œ≤ = let open ‚âÖ-Reasoning in
                begin
                   (swap *ÃÉ) ((repl y‚Ä† *ÃÉ) P‚Ä≤)
                ‚â°‚ü® cong ((swap *ÃÉ) ‚àò·∂† (repl y‚Ä† *ÃÉ)) (sym ‚â°P‚Ä≤) ‚ü©
                   (swap *ÃÉ) ((repl y‚Ä† *ÃÉ) (tgt ((id·∂† *·µá) (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏))) ((repl y‚Ä≤ *ÃÉ) R)))
                ‚â°‚ü® cong ((swap *ÃÉ) ‚àò·∂† (repl y‚Ä† *ÃÉ)) (sym (ren·µá-tgt-comm (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (repl y‚Ä≤) R)) ‚ü©
                   (swap *ÃÉ) ((repl y‚Ä† *ÃÉ) ((suc (repl y‚Ä≤) *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) R)))
                ‚â°‚ü® cong ((swap *ÃÉ) ‚àò·∂† (repl y‚Ä† *ÃÉ) ‚àò·∂† (suc (repl y‚Ä≤) *ÃÉ) ‚àò·∂† tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏))) (sym ‚â°R) ‚ü©
                   (swap *ÃÉ) ((repl y‚Ä† *ÃÉ) ((suc (repl y‚Ä≤) *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))))
                ‚â°‚ü® cong (Œª z ‚Üí (swap *ÃÉ) ((repl z *ÃÉ) ((suc (repl y‚Ä≤) *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P)))))
                        (sym (z‚ÇÅ‚â°z‚ÇÇ y y‚Ä† ‚â°y ‚â°y‚Ä†)) ‚ü©
                   (swap *ÃÉ) ((repl (weaken ÃÉ y) *ÃÉ) ((suc (repl y‚Ä≤) *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))))
                ‚âÖ‚ü® ‚âÖ-sym (id-suc-id-swap-id-suc-idÃÉ y y‚Ä≤ (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))) ‚ü©
                   (repl (weaken ÃÉ y‚Ä≤) *ÃÉ) ((suc (repl y) *ÃÉ) ((swap *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))))
                ‚â°‚ü® cong (Œª z ‚Üí ((repl z *ÃÉ) ((suc (repl y) *ÃÉ) ((swap *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))))))
                        (y‚ÇÅ‚â°y‚ÇÇ y‚Ä≤ y‚Ä° ‚â°y‚Ä≤ ‚â°y‚Ä°) ‚ü©
                   (repl y‚Ä° *ÃÉ) ((suc (repl y) *ÃÉ) ((swap *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))))
                ‚âÖ‚ü® ‚âÖ-cong‚ú¥ ‚Üì_ (Œ≥‚ÇÅ ùê∏) ((repl y‚Ä° *ÃÉ) ‚àò·∂† (suc (repl y) *ÃÉ)) (‚âÖ-sym (reduce-·µá‚àá·µá (Œ≥‚ÇÅ ùê∏) _)) ‚ü©
                   (repl y‚Ä° *ÃÉ) ((suc (repl y) *ÃÉ) (braiding (·µá‚àá·µá {a = x ‚Ä¢} {u ‚Ä¢}) {0} (Œ≥‚ÇÅ ùê∏) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) (tgt E P))))
                ‚â°‚ü® cong ((repl y‚Ä° *ÃÉ) ‚àò·∂† (suc (repl y) *ÃÉ)) IH‚ÇÅ ‚ü©
                   (repl y‚Ä° *ÃÉ) ((suc (repl y) *ÃÉ) (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)) (tgt E‚Ä≤ P)))
                ‚â°‚ü® cong ((repl y‚Ä° *ÃÉ) ‚àò·∂† (suc (repl y) *ÃÉ) ‚àò·∂† tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏))) ‚â°R‚Ä≤ ‚ü©
                   (repl y‚Ä° *ÃÉ) ((suc (repl y) *ÃÉ) (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)) R‚Ä≤))
                ‚â°‚ü® cong (repl y‚Ä° *ÃÉ) (ren·µá-tgt-comm (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)) (repl y) R‚Ä≤) ‚ü©
                   (repl y‚Ä° *ÃÉ) (tgt ((id·∂† *·µá) (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏))) ((repl y *ÃÉ) R‚Ä≤))
                ‚â°‚ü® cong (repl y‚Ä° *ÃÉ) ‚â°P‚Ä≥ ‚ü©
                   (repl y‚Ä° *ÃÉ) P‚Ä≥
                ‚àé
             Œ≥ : (swap *ÃÉ) Q‚Ä≤ ‚âÖ Q‚Ä≥
             Œ≥ = let open ‚âÖ-Reasoning in
                begin
                   (swap *ÃÉ) Q‚Ä≤
                ‚â°‚ü® cong (swap *ÃÉ) (trans (sym ‚â°Q‚Ä≤) (cong (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) (sym ‚â°S))) ‚ü©
                   (swap *ÃÉ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q))
                ‚âÖ‚ü® ‚âÖ-sym (reduce-·µá‚àá·µá (Œ≥‚ÇÅ ùêπ) _) ‚ü©
                   braiding (·µá‚àá·µá {a = ‚Ä¢ x} {‚Ä¢ u}) {0} (Œ≥‚ÇÅ ùêπ) (tgt (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) (tgt F Q))
                ‚â°‚ü® IH‚ÇÇ ‚ü©
                   tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) (tgt F‚Ä≤ Q)
                ‚â°‚ü® trans (cong (tgt (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) ‚â°S‚Ä≤) ‚â°Q‚Ä≥ ‚ü©
                   Q‚Ä≥
                ‚àé
             Œ± : (·¥ø.swap *) ((id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏)))) ‚â° (id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏)))
             Œ± = let open EqReasoning (setoid _) in
                begin
                   (·¥ø.swap *) ((id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏))))
                ‚â°‚ü® cong (·¥ø.swap *) (sym Œ±‚ÇÅ) ‚ü©
                   (·¥ø.swap *) (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏))
                ‚â°‚ü® Œ≥‚ÇÅ ùê∏ ‚ü©
                   tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏)
                ‚â°‚ü® Œ±‚ÇÇ ‚ü©
                   (id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏)))
                ‚àé
             open ‚âÖ-Reasoning in ‚âÖ-to-‚â° (
         begin
            braidÃÇ (Œ≥‚ÇÅ (ùê∏ ‚îÇ·µ•‚Ä≤ ùêπ)) [ ŒΩ [ ŒΩ [ (repl y‚Ä† *ÃÉ) P‚Ä≤ ‚îÇ Q‚Ä≤ ] ] ]
         ‚âÖ‚ü® coerce-braid
               ((repl y‚Ä† *ÃÉ) P‚Ä≤)
               Q‚Ä≤
               (Œ≥‚ÇÅ (ùê∏ ‚îÇ·µ•‚Ä≤ ùêπ))
               (ŒΩŒΩ-swap·µ£ ((id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏))) ‚îÇ tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ)))
               (sym Œ±)
               (sym (Œ≥‚ÇÅ ùêπ)) (‚âÖ-trans Œ≥‚â°Œ≥‚Ä≤ (‚âÖ-cong (Œª P ‚Üí ŒΩŒΩ-swap·µ£ (P ‚îÇ tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ))) (‚â°-to-‚âÖ Œ±‚ÇÅ))) ‚ü©
            [ ŒΩ [ ŒΩ ((swap *ÃÉ) [ (repl y‚Ä† *ÃÉ) P‚Ä≤ ‚îÇ Q‚Ä≤ ]) ] ]
         ‚âÖ‚ü® [ŒΩ-]-cong (cong ŒΩ_ (cong‚ÇÇ _‚îÇ_ Œ± (Œ≥‚ÇÅ ùêπ)))
                      ([ŒΩ-]-cong (cong‚ÇÇ _‚îÇ_ Œ± (Œ≥‚ÇÅ ùêπ)) ([-‚îÇ-]-cong Œ± Œ≤ (Œ≥‚ÇÅ ùêπ) Œ≥)) ‚ü©
            [ ŒΩ [ ŒΩ [ (repl y‚Ä° *ÃÉ) P‚Ä≥ ‚îÇ Q‚Ä≥ ] ] ]
         ‚àé) where
             Œ±‚ÇÅ : tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏) ‚â° (id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏)))
             Œ±‚ÇÅ = trans (sym (*-preserves-id _)) (cong (id·∂† *) (sym (+-id-elim 1 (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏)))))

             Œ±‚ÇÇ : tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏) ‚â° (id·∂† *) ((·¥ø.suc id·∂† *) (tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏)))
             Œ±‚ÇÇ = trans (sym (*-preserves-id _)) (cong (id·∂† *) (sym (+-id-elim 1 (tgt‚ÇÇ (‚äñ‚ÇÅ ùê∏)))))

             Œ≥‚â°Œ≥‚Ä≤ : Œ≥‚ÇÅ (ùê∏ ‚îÇ·µ•‚Ä≤ ùêπ) ‚âÖ ŒΩŒΩ-swap·µ£ (tgt‚ÇÅ (‚äñ‚ÇÅ ùê∏) ‚îÇ tgt‚ÇÅ (‚äñ‚ÇÅ ùêπ))
             Œ≥‚â°Œ≥‚Ä≤ rewrite sym Œ±‚ÇÅ | sym Œ±‚ÇÇ | sym (Œ≥‚ÇÅ ùê∏) | sym (Œ≥‚ÇÅ ùêπ) = ‚âÖ-refl

             open import Braiding.Proc using (_‚ãâÃÇ_)

             coerce-braid : {P‚ÇÅ P‚ÇÇ P‚ÇÉ Q‚ÇÅ Q‚ÇÇ Q‚ÇÉ : Proc (Œì + 2)}
                            (P‚Ä≤ : ‚Üì P‚ÇÅ) (Q‚Ä≤ : ‚Üì Q‚ÇÅ) (Œ≥ : ŒΩ (ŒΩ (P‚ÇÅ ‚îÇ Q‚ÇÅ)) ‚ãâÃÇ ŒΩ (ŒΩ (P‚ÇÇ ‚îÇ Q‚ÇÇ)))
                            (Œ≥‚Ä≤ : ŒΩ (ŒΩ (P‚ÇÅ ‚îÇ Q‚ÇÅ)) ‚ãâÃÇ ŒΩ (ŒΩ (P‚ÇÉ ‚îÇ Q‚ÇÉ))) ‚Üí P‚ÇÇ ‚â° P‚ÇÉ ‚Üí Q‚ÇÇ ‚â° Q‚ÇÉ ‚Üí Œ≥ ‚âÖ Œ≥‚Ä≤ ‚Üí
                            braidÃÇ Œ≥ [ ŒΩ [ ŒΩ [ P‚Ä≤ ‚îÇ Q‚Ä≤ ] ] ] ‚âÖ braidÃÇ Œ≥‚Ä≤ [ ŒΩ [ ŒΩ [ P‚Ä≤ ‚îÇ Q‚Ä≤ ] ] ]
             coerce-braid P‚Ä≤ Q‚Ä≤ Œ≥ ._ refl refl ‚âÖ-refl = ‚âÖ-refl

      subcase :
         braidÃÇ (Œ≥‚ÇÅ (ùê∏ ‚îÇ·µ•‚Ä≤ ùêπ))
         (tgt (ŒΩ·∂ú ((id·∂† *·µá) (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) ‚îÇ·µ• E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) [ ŒΩ [ (repl y‚Ä≤ *ÃÉ) R ‚îÇ S ] ])
         ‚â°
         tgt (ŒΩ·∂ú ((id·∂† *·µá) (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)) ‚îÇ·µ• E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) [ ŒΩ [ (repl y *ÃÉ) R‚Ä≤ ‚îÇ S‚Ä≤ ] ]
      subcase
         with step ((id·∂† *·µá) (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏))) ((repl y‚Ä≤ *ÃÉ) R) | step (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ)) S |
              step ((id·∂† *·µá) (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏))) ((repl y *ÃÉ) R‚Ä≤) | step (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ)) S‚Ä≤ |
              inspect (step ((id·∂† *·µá) (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)))) ((repl y‚Ä≤ *ÃÉ) R) | inspect (step (E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) S |
              inspect (step ((id·∂† *·µá) (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)))) ((repl y *ÃÉ) R‚Ä≤) | inspect (step (E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) S‚Ä≤
      ... | ‚óª , P‚Ä≤ | ‚óª , Q‚Ä≤ | ‚óª , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | ‚óª , P‚Ä≤ | ‚óª , Q‚Ä≤ | ‚óª , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | ‚óª , P‚Ä≤ | ‚óª , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | ‚óª , P‚Ä≤ | ‚óª , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | ‚óª , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | ‚óª , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | ‚óª , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | ‚óª , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | ‚óª , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | ‚óª , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ |
         [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | ‚óª , Q‚Ä≤ | ‚óª , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | ‚óª , Q‚Ä≤ | ‚óª , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | ‚óª , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | ‚óª , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ ‚óª y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª ‚â¢y‚Ä† ‚Üí ‚ä•-elim (‚â¢y‚Ä† (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | ‚óª , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | ‚óª , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ |
         [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | ‚óª , Q‚Ä≥ | [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† ‚óª (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª ‚â¢y‚Ä° ‚Üí ‚ä•-elim (‚â¢y‚Ä° (refl , ,-inj‚ÇÅ ‚â°Q‚Ä≥)))
      ... | [ ._ ‚Ä¢ ·µá ] , P‚Ä≤ | [ ‚Ä¢ ._ Ôπô y‚Ä† Ôπö ·µá ] , Q‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , P‚Ä≥ | [ ‚Ä¢ ._ Ôπô y‚Ä° Ôπö ·µá ] , Q‚Ä≥ |
         [ ‚â°P‚Ä≤ ] | [ ‚â°Q‚Ä≤ ] | [ ‚â°P‚Ä≥ ] | [ ‚â°Q‚Ä≥ ] =
         base P‚Ä≤ Q‚Ä≤ P‚Ä≥ Q‚Ä≥ y‚Ä† y‚Ä° (,-inj‚ÇÇ ‚â°P‚Ä≤) (,-inj‚ÇÇ ‚â°Q‚Ä≤) (,-inj‚ÇÇ ‚â°P‚Ä≥) (,-inj‚ÇÇ ‚â°Q‚Ä≥)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°Q‚Ä≥)

   case : braidÃÇ (Œ≥‚ÇÅ (ùê∏ ‚îÇ·µ•‚Ä≤ ùêπ))
          (tgt (ŒΩ·∂ú ((id·∂† *·µá) (E‚Ä≤/E (‚äñ‚ÇÅ ùê∏)) ‚îÇ·µ• E‚Ä≤/E (‚äñ‚ÇÅ ùêπ))) (tgt (E ‚îÇ·µ• F) [ P ‚îÇ Q ]))
          ‚â°
          tgt (ŒΩ·∂ú ((id·∂† *·µá) (E/E‚Ä≤ (‚äñ‚ÇÅ ùê∏)) ‚îÇ·µ• E/E‚Ä≤ (‚äñ‚ÇÅ ùêπ))) (tgt (E‚Ä≤ ‚îÇ·µ• F‚Ä≤) [ P ‚îÇ Q ])
   case
      with step E‚Ä≤ P | step E P | step F‚Ä≤ Q | step F Q |
           inspect (step E‚Ä≤) P | inspect (step E) P | inspect (step F‚Ä≤) Q | inspect (step F) Q
   ... | ‚óª , R‚Ä≤ | ‚óª , R | ‚óª , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | ‚óª , R‚Ä≤ | ‚óª , R | ‚óª , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | ‚óª , R‚Ä≤ | ‚óª , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | ‚óª , R‚Ä≤ | ‚óª , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | ‚óª , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | ‚óª , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | ‚óª , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | ‚óª , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | ‚óª , R | ‚óª , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | ‚óª , R | ‚óª , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | ‚óª , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | ‚óª , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | ‚óª , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ ‚óª y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª ‚â¢y ‚Üí ‚ä•-elim (‚â¢y (refl , ,-inj‚ÇÅ ‚â°S‚Ä≤))) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | ‚óª , S | [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ ‚óª (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª ‚â¢y‚Ä≤ ‚Üí ‚ä•-elim (‚â¢y‚Ä≤ (refl , ,-inj‚ÇÅ ‚â°S)))
   ... | [ ._ ‚Ä¢ ·µá ] , R‚Ä≤ | [ ._ ‚Ä¢ ·µá ] , R | [ ‚Ä¢ ._ Ôπô y‚Ä≤ Ôπö ·µá ] , S‚Ä≤ | [ ‚Ä¢ ._ Ôπô y Ôπö ·µá ] , S |
      [ ‚â°R‚Ä≤ ] | [ ‚â°R ] | [ ‚â°S‚Ä≤ ] | [ ‚â°S ] =
      subcase R R‚Ä≤ S S‚Ä≤ y‚Ä≤ y (,-inj‚ÇÇ ‚â°R) (,-inj‚ÇÇ ‚â°R‚Ä≤) (,-inj‚ÇÇ ‚â°S) (,-inj‚ÇÇ ‚â°S‚Ä≤)
              (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S‚Ä≤) (Œª _ ‚Üí ,-inj‚ÇÅ ‚â°S)
