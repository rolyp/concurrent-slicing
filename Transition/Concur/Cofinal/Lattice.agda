module Transition.Concur.Cofinal.Lattice where

   open import ConcurrentSlicingCommon
   import Relation.Binary.EqReasoning as EqReasoning

   open import Action as แดฌ using (Action; Actionแต; Actionแถ; inc); open แดฌ.Action; open แดฌ.Actionแต; open แดฌ.Actionแถ
   open import Action.Concur using (_แดฌโฃ_; แดฌโฃ-sym; แดฌโฃ-sym-involutive; module _แดฌโฃ_; แดฌโ; แดฌฮณ); open _แดฌโฃ_
   open import Action.Concur.Lattice using (residual)
   open import Action.Lattice as แดฌฬ using (โแตโป_; โแถโป_); open แดฌฬ.โ_; open แดฌฬ.โโป_; open แดฌฬ.โแตโป_; open แดฌฬ.โแถโป_
   open import Action.Ren.Lattice using () renaming (_* to _แดฌ*ฬ)
   open import Braiding.Proc using (_โฬ_)
   open import Braiding.Proc.Lattice using (braidฬ)
   open import Lattice using (Lattices); open Lattice.Prefixes โฆ...โฆ
   open import Name as แดบ using (Name; Cxt; _+_)
   open import Name.Lattice as แดบฬ using (); open แดบฬ.โ_
   open import Proc as แดพ using (Proc; Procโฑ; Procโฒ); open แดพ.Proc
   open import Proc.Lattice as แดพฬ using (); open แดพฬ.โ_; open แดพฬ.โโป_
   import Proc.Ren
   open import Proc.Ren.Lattice using () renaming (_* to _*ฬ)
   open import Ren as แดฟ using (Ren); open แดฟ.Renameable โฆ...โฆ
   open import Ren.Lattice as แดฟฬ using (_แดฟ+_; swap; push; pop; suc)
   open import Ren.Lattice.Properties
   open import Ren.Properties
   open import Transition as แต using (_โ[_-_]โ_); open แต._โ[_-_]โ_
   open import Transition.Concur using (Concurโ; Concur; module Concurโ; module Deltaโฒ; Delta; โโ; โ); open Concurโ
   open import Transition.Concur.Cofinal using (โฬ[_,_,_]; ฮณโ; ฮณ)
   open import Transition.Concur.Cofinal.Lattice.Helpers
   open import Transition.Lattice as แตฬ using (step; stepโป; action; tgt)
   open import Transition.Ren using (_*แต; _*แถ)
   open import Transition.Ren.Lattice using (renแถ-tgt-comm; renแถ-action-comm; renแต-tgt-comm; renแต-action-comm)

   open Deltaโฒ

   private
      coerceCxt : โ {ฮ} {a aโฒ : Action ฮ} (๐ : a แดฌโฃ aโฒ) โ
                  let ฮโฒ = ฮ + inc aโฒ + inc (ฯโ (แดฌโ ๐)) in โ {P : Proc ฮโฒ} โ โ P โ โ Procโฑ (sym (แดฌฮณ ๐)) P
      coerceCxt ๐ rewrite sym (แดฌฮณ ๐) = idแถ

      gibble : โ {ฮ} {a aโฒ : Action ฮ} (๐ : a แดฌโฃ aโฒ) โ โ ฯโ (แดฌโ (แดฌโฃ-sym ๐)) โ โ ฯโ (แดฌโ ๐)
      gibble ๐ rewrite sym (แดฌฮณ ๐) | แดฌโฃ-sym-involutive ๐ = idแถ

   โปโข[-] : โ {ฮ} {a : Action ฮ} {aโฒ : โโป a} โ _โก_ {A = โ_ {A = Action ฮ} a} โป [ aโฒ ] โ โฅ
   โปโข[-] ()

   [โขxโฉ-โชแถ]-inj : โ {ฮ} {x y : Name ฮ} {yโฒ yโณ : โ y} โ
                 _โก_ {A = โ_ {A = Action ฮ} (โข x โฉ y โช แถ)} [ โข x โฉ yโฒ โช แถ ] [ โข x โฉ yโณ โช แถ ] โ yโฒ โก yโณ
   [โขxโฉ-โชแถ]-inj = ฮป { {yโฒ = yโฒ} {.yโฒ} refl โ refl }

   postulate
      แดฌgammaโ : โ {ฮ} {a aโฒ : Action ฮ} {๐ : a แดฌโฃ aโฒ} {P R Rโฒ} {E : P โ[ a - _ ]โ R} {Eโฒ : P โ[ aโฒ - _ ]โ Rโฒ}
                (๐ธ : E โฃโ[ ๐ ] Eโฒ) โ โ Pโฒ โ
                action (Eโฒ/E (โโ ๐ธ)) (tgt E Pโฒ) โก gibble ๐ (residual (แดฌโฃ-sym ๐) (action Eโฒ Pโฒ))
--              ร
--              action (E/Eโฒ (โโ ๐ธ)) (tgt Eโฒ Pโฒ) โก residual ๐ (action E Pโฒ)

   -- ฮณโ lifted to the lattice setting. Can't seem to avoid inspect-on-steroids here, ouch.
   gammaโ : โ {ฮ} {a aโฒ : Action ฮ} {๐ : a แดฌโฃ aโฒ} {P R Rโฒ} {E : P โ[ a - _ ]โ R} {Eโฒ : P โ[ aโฒ - _ ]โ Rโฒ}
            (๐ธ : E โฃโ[ ๐ ] Eโฒ) โ โ Pโฒ โ
            braiding ๐ (ฮณโ ๐ธ) (tgt (Eโฒ/E (โโ ๐ธ)) (tgt E Pโฒ)) โก coerceCxt ๐ (tgt (E/Eโฒ (โโ ๐ธ)) (tgt Eโฒ Pโฒ))

{-
   gammaโ {๐ = หฃโหฃ {x = x} {u}} ๐ธ โป =
      โ-to-โก (โ-trans (reduce-หฃโหฃ {x = x} {u} (ฮณโ ๐ธ) _) (โป-cong (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl _)))))
   gammaโ {๐ = แตโแต} ๐ธ โป =
      โ-to-โก (โ-trans (reduce-แตโแต (ฮณโ ๐ธ) _) (โป-cong (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl _)))))
   gammaโ {๐ = แตโแถ} ๐ธ โป =
      โ-to-โก (โ-trans (reduce-แตโแถ (ฮณโ ๐ธ) _) (โป-cong (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl _)))))
   gammaโ {๐ = แถโแต} ๐ธ โป =
      โ-to-โก (โ-trans (reduce-แถโแต (ฮณโ ๐ธ) _) (โป-cong (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl _)))))
   gammaโ {๐ = แถโแถ} ๐ธ โป =
      โ-to-โก (โ-trans (reduce-แถโแถ (ฮณโ ๐ธ) _) (โป-cong (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl _)))))
   gammaโ {๐ = แตโแต} ๐ธ โป = refl

   gammaโ {a = a แต} {aโฒ แต} {E = .E แตโ Qโ} {Eโฒ = Pโ โแต .F} (E แตโแต F) [ P โ Q ] =
      let Sโ : ฯโ (step ((แดฟ.push *แต) E) ((push *ฬ) P)) โ (swap *ฬ) ((push *ฬ) (ฯโ (step E P)))
          Sโ = โ-trans (โก-to-โ (sym (renแต-tgt-comm E push P))) (swapโpushฬ _)
          Sโก : (push *ฬ) (ฯโ (step F Q)) โ (swap *ฬ) (ฯโ (step ((แดฟ.push *แต) F) ((push *ฬ) Q)))
          Sโก = โ-trans (swapโsuc-pushฬ _) (โก-to-โ (cong (swap *ฬ) (renแต-tgt-comm F push Q)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding (แตโแต {a = a} {aโฒ}) {0} (sym (congโ _โ_ (swapโpush (แต.tgt E)) (swapโsuc-push (แต.tgt F))))
                                        [ (push *ฬ) (ฯโ (step E P)) โ ฯโ (step ((แดฟ.push *แต) F) ((push *ฬ) Q)) ]
      โโจ reduce-แตโแต (sym (congโ _โ_ (swapโpush (แต.tgt E)) (swapโsuc-push (แต.tgt F)))) _ โฉ
         [ (swap *ฬ) ((push *ฬ) (ฯโ (step E P))) โ (swap *ฬ) (ฯโ (step ((แดฟ.push *แต) F) ((push *ฬ) Q))) ]
      โโจ โ-sym ([-โ-]-cong (swapโpush (แต.tgt E)) Sโ (swapโsuc-push (แต.tgt F)) Sโก) โฉ
         [ ฯโ (step ((แดฟ.push *แต) E) ((push *ฬ) P)) โ (push *ฬ) (ฯโ (step F Q)) ]
      โ)

   gammaโ (E แตโแถ F) [ P โ Q ] = cong (ฮป Qโฒ โ [ _ โ Qโฒ ]) (sym (renแถ-tgt-comm F push Q))

   gammaโ (E แถโแต F) [ P โ Q ] = cong (ฮป Pโฒ โ [ Pโฒ โ _ ]) (renแถ-tgt-comm E push P)

   gammaโ (E แถโแถ F) [ P โ Q ] = refl

   gammaโ (๐ธ โโ Q) [ P โ _ ] = gammaโ ๐ธ P

   gammaโ {๐ = หฃโหฃ {x = x} {u}} {E = _ โแต F} {._ โแต Fโฒ} (._ โแตแต ๐น) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐น)) (ฯโ (step Fโฒ Q)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐น)) (ฯโ (step F Q)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding (หฃโหฃ {x = x} {u}) {0} (congโ _โ_ refl (ฮณโ ๐น)) [ (push *ฬ) P โ Sโก ]
      โโจ reduce-หฃโหฃ {x = x} {u} (congโ _โ_ refl (ฮณโ ๐น)) _ โฉ
         [ (push *ฬ) P โ Sโก ]
      โโจ [โ-]-cong _ (trans (ฮณโ ๐น) (โ-to-โก (Procโฒ refl (tgtโ (โโ ๐น)))))
                     (โ-trans (โ-sym (reduce-หฃโหฃ {x = x} {u} (ฮณโ ๐น) _)) (โก-to-โ (gammaโ ๐น Q))) โฉ
         [ (push *ฬ) P โ Sโ ]
      โ)

   gammaโ {๐ = แตโแต} {E = Pโ โแต F} {._ โแต Fโฒ} (._ โแตแต ๐น) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐น)) (ฯโ (step Fโฒ Q)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐น)) (ฯโ (step F Q)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding แตโแต {0} (congโ _โ_ (swapโpushโpush Pโ) (ฮณโ ๐น)) [ (push *ฬ) ((push *ฬ) P) โ Sโก ]
      โโจ reduce-แตโแต (congโ _โ_ (swapโpushโpush Pโ) (ฮณโ ๐น)) _ โฉ
         [ (swap *ฬ) ((push *ฬ) ((push *ฬ) P)) โ (swap *ฬ) Sโก ]
      โโจ [-โ-]-cong (swapโpushโpush Pโ) (swapโpushโpushฬ P)
                    (ฮณโ ๐น) (โ-trans (โ-sym (reduce-แตโแต (ฮณโ ๐น) Sโก)) (โก-to-โ (gammaโ ๐น Q))) โฉ
         [ (push *ฬ) ((push *ฬ) P) โ Sโ ]
      โ)

   gammaโ {E = _ โแต F} {._ โแถ Fโฒ} (._ โแตแถ ๐น) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐น)) (ฯโ (step Fโฒ Q)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐น)) (ฯโ (step F Q)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding แตโแถ (congโ _โ_ refl (ฮณโ ๐น)) [ (push *ฬ) P โ Sโก ]
      โโจ reduce-แตโแถ (congโ _โ_ refl (ฮณโ ๐น)) _ โฉ
         [ (push *ฬ) P โ Sโก ]
      โโจ [โ-]-cong _ (trans (ฮณโ ๐น) (โ-to-โก (Procโฒ refl (tgtโ (โโ ๐น)))))
                     (โ-trans (โ-sym (reduce-แตโแถ (ฮณโ ๐น) _)) (โก-to-โ (gammaโ ๐น Q))) โฉ
         [ (push *ฬ) P โ Sโ ]
      โ)

   gammaโ {E = _ โแถ F} {._ โแถ Fโฒ} (._ โแถแถ ๐น) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐น)) (ฯโ (step Fโฒ Q)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐น)) (ฯโ (step F Q)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding แถโแถ (congโ _โ_ refl (ฮณโ ๐น)) [ P โ Sโก ]
      โโจ reduce-แถโแถ (congโ _โ_ refl (ฮณโ ๐น)) _ โฉ
         [ P โ Sโก ]
      โโจ [โ-]-cong _ (trans (ฮณโ ๐น) (โ-to-โก (Procโฒ refl (tgtโ (โโ ๐น)))))
                     (โ-trans (โ-sym (reduce-แถโแถ (ฮณโ ๐น) _)) (โก-to-โ (gammaโ ๐น Q))) โฉ
         [ P โ Sโ ]
      โ)

   gammaโ {E = Pโ โแถ F} {._ โแถ Fโฒ} (._ โแตแต ๐น) [ P โ Q ] = cong (ฮป Q โ [ P โ Q ]) (gammaโ ๐น Q)

   gammaโ {๐ = หฃโหฃ {x = x} {u}} {E = E แตโ Qโ} {Eโฒ แตโ ._} (๐ธ แตแตโ ._) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐ธ)) (ฯโ (step Eโฒ P)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐ธ)) (ฯโ (step E P)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding (หฃโหฃ {x = x} {u}) {0} (congโ _โ_ (ฮณโ ๐ธ) refl) [ Sโก โ (push *ฬ) Q ]
      โโจ reduce-หฃโหฃ {x = x} {u} (congโ _โ_ (ฮณโ ๐ธ) refl) _ โฉ
         [ Sโก โ (push *ฬ) Q ]
      โโจ [-โ]-cong _ (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl (tgtโ (โโ ๐ธ)))))
                     (โ-trans (โ-sym (reduce-หฃโหฃ {x = x} {u} (ฮณโ ๐ธ) _)) (โก-to-โ (gammaโ ๐ธ P))) โฉ
         [ Sโ โ (push *ฬ) Q ]
      โ)

   gammaโ {๐ = แตโแต} {E = E แตโ Qโ} {Eโฒ แตโ ._} (๐ธ แตแตโ ._) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐ธ)) (ฯโ (step Eโฒ P)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐ธ)) (ฯโ (step E P)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding แตโแต {0} (congโ _โ_ (ฮณโ ๐ธ) (swapโpushโpush Qโ)) [ Sโก โ (push *ฬ) ((push *ฬ) Q) ]
      โโจ reduce-แตโแต (congโ _โ_ (ฮณโ ๐ธ) (swapโpushโpush Qโ)) _ โฉ
         [ (swap *ฬ) Sโก โ (swap *ฬ) ((push *ฬ) ((push *ฬ) Q)) ]
      โโจ [-โ-]-cong (ฮณโ ๐ธ) (โ-trans (โ-sym (reduce-แตโแต (ฮณโ ๐ธ) Sโก)) (โก-to-โ (gammaโ ๐ธ P)))
                    (swapโpushโpush Qโ) (swapโpushโpushฬ Q) โฉ
         [ Sโ โ (push *ฬ) ((push *ฬ) Q) ]
      โ)

   gammaโ {E = E แตโ _} {Eโฒ แถโ ._} (๐ธ แตแถโ ._) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐ธ)) (ฯโ (step Eโฒ P)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐ธ)) (ฯโ (step E P)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding แตโแถ (congโ _โ_ (ฮณโ ๐ธ) refl) [ Sโก โ (push *ฬ) Q ]
      โโจ reduce-แตโแถ (congโ _โ_ (ฮณโ ๐ธ) refl) _ โฉ
         [ Sโก โ (push *ฬ) Q ]
      โโจ [-โ]-cong _ (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl (tgtโ (โโ ๐ธ)))))
                     (โ-trans (โ-sym (reduce-แตโแถ (ฮณโ ๐ธ) _)) (โก-to-โ (gammaโ ๐ธ P))) โฉ
         [ Sโ โ (push *ฬ) Q ]
      โ)

   gammaโ {E = E แถโ _} {Eโฒ แถโ ._} (๐ธ แถแถโ ._) [ P โ Q ] =
      let Sโ = ฯโ (step (E/Eโฒ (โโ ๐ธ)) (ฯโ (step Eโฒ P)))
          Sโก = ฯโ (step (Eโฒ/E (โโ ๐ธ)) (ฯโ (step E P)))
          open โ-Reasoning in โ-to-โก (
      begin
         braiding แถโแถ (congโ _โ_ (ฮณโ ๐ธ) refl) [ Sโก โ  Q ]
      โโจ reduce-แถโแถ (congโ _โ_ (ฮณโ ๐ธ) refl) _ โฉ
         [ Sโก โ Q ]
      โโจ [-โ]-cong _ (trans (ฮณโ ๐ธ) (โ-to-โก (Procโฒ refl (tgtโ (โโ ๐ธ)))))
                     (โ-trans (โ-sym (reduce-แถโแถ (ฮณโ ๐ธ) _)) (โก-to-โ (gammaโ ๐ธ P))) โฉ
         [ Sโ โ Q ]
      โ)

   gammaโ {E = E แถโ Qโ} {Eโฒ แถโ ._} (๐ธ แตแตโ ._) [ P โ Q ] = cong (ฮป P โ [ P โ Q ]) (gammaโ ๐ธ P)

   gammaโ {E = E แตโ _} {Eโฒ = Eโฒ โโข .F} (_โโขแต_ {x = x} {y} {a = a} ๐ธ F) [ P โ Q ]
      with step Eโฒ P | inspect (step Eโฒ) P
   ... | โป , Rโฒ | [ โกRโฒ ]
      with step (Eโฒ/E (โโ ๐ธ)) (tgt E P) | inspect (step (Eโฒ/E (โโ ๐ธ))) (tgt E P)
   ... | โป , Pโฒ | [ โกPโฒ ] =
      let Sโ = tgt ((แดฟ.push *แถ) F) ((push *ฬ) Q); Sโก = tgt F Q in
      gammaโ-โโขแต ๐ธ F P Q Sโ Sโก Rโฒ Pโฒ โป โป (,-injโ โกRโฒ) (,-injโ โกPโฒ) refl refl refl (gammaโ ๐ธ P)
   ... | [ (._ โข) แต ] , Pโฒ | [ โกPโฒ ] =
      โฅ-elim (โปโข[-] (trans (cong (push แดฌ*ฬ) (sym (,-injโ โกRโฒ))) (trans (sym (แดฌgammaโ ๐ธ P)) (,-injโ โกPโฒ))))
   gammaโ {E = E แตโ _} {Eโฒ โโข .F} (๐ธ โโขแต F) [ P โ Q ] |
      [ x โข แต ] , Rโฒ | [ โกRโฒ ]
      with step (Eโฒ/E (โโ ๐ธ)) (tgt E P) | inspect (step (Eโฒ/E (โโ ๐ธ))) (tgt E P) |
           step F Q | inspect (step F) Q
   ... | โป , Pโฒ | [ โกPโฒ ] | โป , Sโก | [ โกSโก ] =
      โฅ-elim (โปโข[-] (trans (sym (,-injโ โกPโฒ)) (trans (แดฌgammaโ ๐ธ P) (cong (push แดฌ*ฬ) (,-injโ โกRโฒ)))))
   ... | [ (._ โข) แต ] , Pโฒ | [ โกPโฒ ] | โป , Sโก | [ โกSโก ]
      with step ((แดฟ.push *แถ) F) ((push *ฬ) Q) | inspect (step ((แดฟ.push *แถ) F)) ((push *ฬ) Q)
   ... | โป , Sโ | [ โกSโ ] =
      gammaโ-โโขแต ๐ธ F P Q Sโ Sโก Rโฒ Pโฒ โป โป (,-injโ โกRโฒ) (,-injโ โกPโฒ) (,-injโ โกSโ) (,-injโ โกSโก) refl (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ yโฒ โช แถ ] , Sโ | [ โกSโ ] =
      โฅ-elim (โปโข[-] (trans (cong (push แดฌ*ฬ) (sym (,-injโ โกSโก))) (trans (renแถ-action-comm F push Q) (,-injโ โกSโ))))
   gammaโ {E = E แตโ _} {Eโฒ โโข .F} (๐ธ โโขแต F) [ P โ Q ] |
      [ x โข แต ] , Rโฒ | [ โกRโฒ ] | โป , Pโฒ | [ โกPโฒ ] | [ โข .x โฉ yโก โช แถ ] , Sโก | [ โกSโก ] =
      โฅ-elim (โปโข[-] (trans (sym (,-injโ โกPโฒ)) (trans (แดฌgammaโ ๐ธ P) (cong (push แดฌ*ฬ) (,-injโ โกRโฒ)))))
   gammaโ {E = E แตโ _} {Eโฒ โโข .F} (_โโขแต_ {y = y} {a = a} ๐ธ F) [ P โ Q ] |
      [ x โข แต ] , Rโฒ | [ โกRโฒ ] | [ ._ โข แต ] , Pโฒ | [ โกPโฒ ] | [ โข .x โฉ yโก โช แถ ] , Sโก | [ โกSโก ]
      with step ((แดฟ.push *แถ) F) ((push *ฬ) Q) | inspect (step ((แดฟ.push *แถ) F)) ((push *ฬ) Q)
   ... | โป , Sโ | [ โกSโ ] =
      โฅ-elim (โปโข[-] (trans (sym (,-injโ โกSโ)) (trans (sym (renแถ-action-comm F push Q)) (cong (push แดฌ*ฬ) (,-injโ โกSโก)))))
   ... | [ โข .(แดบ.suc x) โฉ yโ โช แถ ] , Sโ | [ โกSโ ] =
      let ฮฑ : [ โข แดบ.suc x โฉ (push แดฟฬ.*) yโก โช แถ ] โก [ โข แดบ.suc x โฉ yโ โช แถ ]
          ฮฑ = trans (sym (cong (push แดฌ*ฬ) (,-injโ โกSโก))) (trans (renแถ-action-comm F push Q) (,-injโ โกSโ)) in
      gammaโ-โโขแต ๐ธ F P Q Sโ Sโก Rโฒ Pโฒ yโ yโก (,-injโ โกRโฒ) (,-injโ โกPโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (sym ([โขxโฉ-โชแถ]-inj ฮฑ)) (gammaโ ๐ธ P)

   gammaโ {E = E แถโ Qโ} {Eโฒ = Eโฒ โโข .F} (_โโขแถ_ {x = x} {y} {a = a} ๐ธ F) [ P โ Q ]
      with step Eโฒ P | step (Eโฒ/E (โโ ๐ธ)) (tgt E P) | step F Q |
           inspect (step Eโฒ) P | inspect (step (Eโฒ/E (โโ ๐ธ))) (tgt E P) | inspect (step F) Q
   ... | โป , Rโฒ | โป , Sโ | _ , Sโก | [ โกRโฒ ] | [ โกSโ ] | [ โกSโก ] =
      gammaโ-โโขแถ ๐ธ F P Q Sโ Sโก Rโฒ โป (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | โป , Rโฒ | [ (.x โข) แต ] , Sโ | _ , Sโก | [ โกRโฒ ] | [ โกSโ ] | [ โกSโก ] =
      โฅ-elim (โปโข[-] (trans (sym (,-injโ โกRโฒ)) (trans (sym (แดฌgammaโ ๐ธ P)) (,-injโ โกSโ))))
   ... | [ (.x โข) แต ] , Rโฒ | โป , Sโ | _ , Sโก | [ โกRโฒ ] | [ โกSโ ] | [ โกSโก ] =
      โฅ-elim (โปโข[-] (sym (trans (sym (,-injโ โกRโฒ)) (trans (sym (แดฌgammaโ ๐ธ P)) (,-injโ โกSโ)))))
   ... | [ (.x โข) แต ] , Rโฒ | [ (.x โข) แต ] , Sโ | โป , Sโก | [ โกRโฒ ] | [ โกSโ ] | [ โกSโก ] =
      gammaโ-โโขแถ ๐ธ F P Q Sโ Sโก Rโฒ โป (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ (.x โข) แต ] , Rโฒ | [ (.x โข) แต ] , Sโ | [ โข .x โฉ yโก โช แถ ] , Sโก | [ โกRโฒ ] | [ โกSโ ] | [ โกSโก ] =
      gammaโ-โโขแถ ๐ธ F P Q Sโ Sโก Rโฒ yโก (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)

   gammaโ {E = Pโ โแต F} {Eโฒ = .E โโข Fโฒ} (_แตโโข_ {y = y} E ๐น) [ P โ Q ]
      with step Fโฒ Q | step (Eโฒ/E (โโ ๐น)) (tgt F Q) | step E P | step ((แดฟ.push *แต) E) ((push *ฬ) P) |
           inspect (step Fโฒ) Q | inspect (step (Eโฒ/E (โโ ๐น))) (tgt F Q) | inspect (step E) P |
           inspect (step ((แดฟ.push *แต) E)) ((push *ฬ) P)
   ... | โป , Sโฒ | โป , Qโฒ | โป , R | โป , Rโ | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] | [ โกRโ ] =
      gammaโ-แตโโข E ๐น P Q R Rโ Sโฒ Qโฒ โป โป (,-injโ โกR) (,-injโ โกRโ) (,-injโ โกSโฒ) (,-injโ โกQโฒ) refl (gammaโ ๐น Q)
   ... | _ | _ | [ _ แต ] , R | โป , Rโ | _ | _ | [ โกR ] | [ โกRโ ] =
      โฅ-elim (โปโข[-] (sym (trans (cong (push แดฌ*ฬ) (sym (,-injโ โกR))) (trans (renแต-action-comm E push P) (,-injโ โกRโ)))))
   ... | _ | _ | โป , R | [ _ แต ] , Rโ | _ | _ | [ โกR ] | [ โกRโ ] =
      โฅ-elim (โปโข[-] (trans (cong (push แดฌ*ฬ) (sym (,-injโ โกR))) (trans (renแต-action-comm E push P) (,-injโ โกRโ))))
   ... | โป , Sโฒ | โป , Qโฒ | [ (x โข) แต ] , R | [ (.(แดบ.suc x) โข) แต ] , Rโ | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] | [ โกRโ ] =
      gammaโ-แตโโข E ๐น P Q R Rโ Sโฒ Qโฒ โป โป (,-injโ โกR) (,-injโ โกRโ) (,-injโ โกSโฒ) (,-injโ โกQโฒ) refl (gammaโ ๐น Q)
   ... | โป , Sโฒ | [ โข ._ โฉ _ โช แถ ] , Qโฒ | _ | _ | [ โกSโฒ ] | [ โกQโฒ ] | _ | _ =
      โฅ-elim (โปโข[-] (trans (sym (cong (push แดฌ*ฬ) (,-injโ โกSโฒ))) (trans (sym (แดฌgammaโ ๐น Q)) (,-injโ โกQโฒ))))
   ... | [ โข _ โฉ _ โช แถ ] , Sโฒ | โป , _ | _ | _ | [ โกSโฒ ] | [ โกQโฒ ] | _ | _ =
      โฅ-elim (โปโข[-] (sym (trans (sym (cong (push แดฌ*ฬ) (,-injโ โกSโฒ))) (trans (sym (แดฌgammaโ ๐น Q)) (,-injโ โกQโฒ)))))
   ... | [ โข x โฉ _ โช แถ ] , Sโฒ | [ โข .(แดบ.suc x) โฉ _ โช แถ ] , Qโฒ | โป , R | โป , Rโ | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] | [ โกRโ ] =
      gammaโ-แตโโข E ๐น P Q R Rโ Sโฒ Qโฒ โป โป (,-injโ โกR) (,-injโ โกRโ) (,-injโ โกSโฒ) (,-injโ โกQโฒ) refl (gammaโ ๐น Q)
   ... | [ โข x โฉ yโก โช แถ ] , Sโฒ | [ โข .(แดบ.suc x) โฉ yโ โช แถ ] , Qโฒ | [ (.x โข) แต ] , R | [ .(แดบ.suc x) โข แต ] , Rโ
       | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] | [ โกRโ ] =
      let ฮฑ : [ โข แดบ.suc x โฉ (push แดฟฬ.*) yโก โช แถ ] โก [ โข แดบ.suc x โฉ yโ โช แถ ]
          ฮฑ = trans (sym (cong (push แดฌ*ฬ) (,-injโ โกSโฒ))) (trans (sym (แดฌgammaโ ๐น Q)) (,-injโ โกQโฒ)) in
      gammaโ-แตโโข E ๐น P Q R Rโ Sโฒ Qโฒ yโ yโก (,-injโ โกR) (,-injโ โกRโ) (,-injโ โกSโฒ) (,-injโ โกQโฒ) (sym ([โขxโฉ-โชแถ]-inj ฮฑ)) (gammaโ ๐น Q)

   gammaโ {E = Pโ โแถ F} {Eโฒ = .E โโข Fโฒ} (_แถโโข_ {y = y} E ๐น) [ P โ Q ]
      with step Fโฒ Q | step (Eโฒ/E (โโ ๐น)) (tgt F Q) | step E P |
           inspect (step Fโฒ) Q | inspect (step (Eโฒ/E (โโ ๐น))) (tgt F Q) | inspect (step E) P
   ... | โป , Sโฒ | โป , Qโฒ | โป , R | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] =
      gammaโ-แถโโข E ๐น P Q R Sโฒ Qโฒ โป โป (,-injโ โกR) (,-injโ โกSโฒ) (,-injโ โกQโฒ) refl (gammaโ ๐น Q)
   ... | โป , Sโฒ | โป , Qโฒ | [ (x โข) แต ] , R | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] =
      gammaโ-แถโโข E ๐น P Q R Sโฒ Qโฒ โป โป (,-injโ โกR) (,-injโ โกSโฒ) (,-injโ โกQโฒ) refl (gammaโ ๐น Q)
   ... | โป , Sโฒ | [ _ ] , Qโฒ | _ | [ โกSโฒ ] | [ โกQโฒ ] | _ =
      โฅ-elim (โปโข[-] (trans (sym (,-injโ โกSโฒ)) (trans (sym (แดฌgammaโ ๐น Q)) (,-injโ โกQโฒ))))
   ... | [ _ ] , Sโฒ | โป , Qโฒ | _ | [ โกSโฒ ] | [ โกQโฒ ] | _ =
      โฅ-elim (โปโข[-] (sym (trans (sym (,-injโ โกSโฒ)) (trans (sym (แดฌgammaโ ๐น Q)) (,-injโ โกQโฒ)))))
   ... | [ _ แถ ] , Sโฒ | [ _ แถ ] , Qโฒ | โป , R | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] =
      gammaโ-แถโโข E ๐น P Q R Sโฒ Qโฒ โป โป (,-injโ โกR) (,-injโ โกSโฒ) (,-injโ โกQโฒ) refl (gammaโ ๐น Q)
   ... | [ โข x โฉ yโ โช แถ ] , Sโฒ | [ โข .x โฉ yโก โช แถ ] , Qโฒ | [ (.x โข) แต ] , R | [ โกSโฒ ] | [ โกQโฒ ] | [ โกR ] =
      let ฮฑ : [ โข x โฉ yโก โช แถ ] โก [ โข x โฉ yโ โช แถ ]
          ฮฑ = trans (sym (,-injโ โกQโฒ)) (trans (แดฌgammaโ ๐น Q) (,-injโ โกSโฒ)) in
      gammaโ-แถโโข E ๐น P Q R Sโฒ Qโฒ yโ yโก (,-injโ โกR) (,-injโ โกSโฒ) (,-injโ โกQโฒ) (sym ([โขxโฉ-โชแถ]-inj ฮฑ)) (gammaโ ๐น Q)
-}

{-
   gammaโ {E = E แตโ Qโ} {Eโฒ โแตฅ .F} (๐ธ โแตฅแต F) P = {!!}
   gammaโ {E = E แถโ Qโ} {Eโฒ โแตฅ .F} (๐ธ โแตฅแถ F) Pโ = {!!}
   gammaโ (E แตโแตฅ ๐ธ) Pโ = {!!}
   gammaโ (E แถโแตฅ ๐ธ) Pโ = {!!}
   gammaโ (๐ธ โโข ๐น) Pโ = {!!}
   gammaโ (๐ธ โโขแตฅ ๐น) Pโ = {!!}
   gammaโ (๐ธ โแตฅ ๐น) Pโ = {!!}
-}

   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ]
      with step Eโฒ P | step E P | step Fโฒ Q | step F Q |
           inspect (step Eโฒ) P | inspect (step E) P | inspect (step Fโฒ) Q | inspect (step F) Q
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | โป , R | โป , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | โป , R | โป , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | โป , R | [ (โข ._) แต ] , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | โป , R | [ (โข ._) แต ] , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | [ _ โข แต ] , R | โป , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | [ _ โข แต ] , R | โป , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | [ _ โข แต ] , R | [ (โข _) แต ] , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      โป , Rโฒ | [ _ โข แต ] , R | [ (โข _) แต ] , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | โป , R | โป , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | โป , R | โป , Sโฒ | [ (โข _) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | โป , R | [ (โข ._) แต ] , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | โป , R | [ (โข ._) แต ] , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | [ _ โข แต ] , R | โป , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | [ _ โข แต ] , R | โป , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | [ _ โข แต ] , R | [ (โข ._) แต ] , Sโฒ | โป , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   gammaโ {E = E โแตฅ F} {Eโฒ โแตฅ Fโฒ} (๐ธ โแตฅโฒ ๐น) [ P โ Q ] |
      [ _ โข แต ] , Rโฒ | [ _ โข แต ] , R | [ (โข ._) แต ] , Sโฒ | [ (โข ._) แต ] , S | [ โกRโฒ ] | [ โกR ] | [ โกSโฒ ] | [ โกS ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (Eโฒ/E (โโ ๐น)) S | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (E/Eโฒ (โโ ๐น)) Sโฒ
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | โป , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | โป , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | โป , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | โป , Qโณ = {!!}
   ... | [ (._ โข) แต ] , Pโฒ | [ (โข ._) แต ] , Qโฒ | [ (._ โข) แต ] , Pโณ | [ (โข ._) แต ] , Qโณ = {!!}

{-
   gammaโ {E = ฮฝโข E} {ฮฝโข Eโฒ} (ฮฝโข ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   ... | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ] =
      gammaโ-ฮฝโข ๐ธ P R Rโฒ (,-injโ โกR) (,-injโ โกRโฒ) (gammaโ ๐ธ P)

   -- Sub-case 1.
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ โป โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = โข x โฉ _ โช แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 2.
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = ฯ แถ} {E = ฮฝโข E} {ฮฝแถ Eโฒ} (ฮฝโขแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .แดบ.zero ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแถ ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 1.
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (x โข) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 2.
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {aโฒ = (โข x) แต} {E = ฮฝโข E} {ฮฝแต Eโฒ} (ฮฝโขแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกSโฒ ] = gammaโ-ฮฝโขแต ๐ธ P R Rโฒ Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 1.
   gammaโ {a = x โข แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = x โข แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 2.
   gammaโ {a = (x โข) แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = x โข แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 3.
   gammaโ {a = (โข x) แต} {(xโฒ โข) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = (โข x) แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {xโฒ โข แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ ._ โข แต ] , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ._ โข แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 4.
   gammaโ {a = (โข x) แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = (โข x) แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {(โข xโฒ) แต} {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แต) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) |
           inspect (step ((แดฟ.swap *แต) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ (โข ._) แต ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   gammaโ {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝหฃหฃ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   ... | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝหฃหฃ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝหฃหฃ ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {E = ฮฝแต E} {ฮฝแต Eโฒ} (ฮฝหฃหฃ ๐ธ) [ ฮฝ P ] | [ (โข ._) แต ] , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ))) ((swap *ฬ) Rโฒ) |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step ((แดฟ.swap *แถ) (E/Eโฒ (โโ ๐ธ)))) ((swap *ฬ) Rโฒ)
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , S | [ โข ._ โฉ [ .(แดบ.suc แดบ.zero) ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝหฃหฃ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 1.
   gammaโ {a = (x โข) แต} {โข xโฒ โฉ y โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = x โข แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ โป โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 2.
   gammaโ {a = (x โข) แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = x โข แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = x โข แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ ._ โข แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ._ โข แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 3.
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ y โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ โป โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {โข xโฒ โฉ _ โช แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] |
      [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 4.
   gammaโ {a = (โข x) แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = (โข x) แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = (โข x) แต} {ฯ แถ} {E = ฮฝแต E} {ฮฝแถ Eโฒ} (ฮฝแตแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ (โข ._) แต ] , R | [ โกRโฒ ] | [ โกR ]
      with step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ))) ((swap *ฬ) R) | step (E/Eโฒ (โโ ๐ธ)) Rโฒ |
           inspect (step ((แดฟ.swap *แถ) (Eโฒ/E (โโ ๐ธ)))) ((swap *ฬ) R) | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ (โข ._) แต ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแตแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 1.
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | [ โข ._ โฉ โป โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {โข xโฒ โฉ yโฒ โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
       | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ .(แดบ.suc yโฒ) ] โช แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 2.
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ โข ._ โฉ โป โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = โข x โฉ y โช แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ โข ._ โฉ [ ._ ] โช แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ โป โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ โข ._ โฉ [ ._ ] โช แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 3.
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ]  , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ]  , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ โป โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ]  , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ]  , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ โป โช แถ ] , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ]  , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {โข x โฉ y โช แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ โข ._ โฉ [ ._ ] โช แถ ] , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ โป โช แถ ]  , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ โข ._ โฉ [ ._ ] โช แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   -- Sub-case 4.
   gammaโ {a = ฯ แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   gammaโ {a = ฯ แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   gammaโ {a = ฯ แถ} {ฯ แถ} {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแถแถ ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (Eโฒ/E (โโ ๐ธ)) R | step (E/Eโฒ (โโ ๐ธ)) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ
   ... | โป , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | โป , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | โป , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , S | [ ฯ แถ ] , Sโฒ | [ โกS ] | [ โกSโฒ ] =
      gammaโ-ฮฝแถแถ ๐ธ P R Rโฒ S Sโฒ (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกS) (,-injโ โกSโฒ) (gammaโ ๐ธ P)

   gammaโ {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ]
      with step Eโฒ P | step E P | inspect (step Eโฒ) P | inspect (step E) P
   ... | โป , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (Eโฒ/E (โโ ๐ธ)) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R
   ... | โป , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | โป , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   gammaโ {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | โป , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (Eโฒ/E (โโ ๐ธ)) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R
   ... | โป , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | โป , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   gammaโ {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | โป , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (Eโฒ/E (โโ ๐ธ)) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R
   ... | โป , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | โป , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   gammaโ {E = ฮฝแถ E} {ฮฝแถ Eโฒ} (ฮฝแตแต ๐ธ) [ ฮฝ P ] | [ ฯ แถ ] , Rโฒ | [ ฯ แถ ] , R | [ โกRโฒ ] | [ โกR ]
      with step (E/Eโฒ (โโ ๐ธ)) Rโฒ | step (Eโฒ/E (โโ ๐ธ)) R | inspect (step (E/Eโฒ (โโ ๐ธ))) Rโฒ | inspect (step (Eโฒ/E (โโ ๐ธ))) R
   ... | โป , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | โป , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | โป , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)
   ... | [ ฯ แถ ] , Sโก | [ ฯ แถ ] , Sโ | [ โกSโก ] | [ โกSโ ] =
      gammaโ-ฮฝแตแต ๐ธ P R Rโฒ Sโ Sโก (,-injโ โกR) (,-injโ โกRโฒ) (,-injโ โกSโ) (,-injโ โกSโก) (gammaโ ๐ธ P)

   gammaโ (! ๐ธ) [ ! P ] = gammaโ ๐ธ [ P โ [ ! P ] ]
-}

   gammaโ _ _ = {!!}
